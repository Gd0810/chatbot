<!-- templates/dashboard/partials/account.html -->
{% include 'toast.html' %}

<style>
  /* Theme variables for account page */
  :root {
    --account-bg: #f8f9fa;
    --account-card-bg: #f8f9fa;
    --account-text-primary: #1f1f1f;
    --account-text-secondary: #5f6368;
    --account-border: #e0e0e0;
    --account-input-bg: #ffffff;
    --account-input-border: #dadce0;
    --account-button-bg: #1a73e8;
    --account-button-hover: #1557b0;
    --account-link-color: #1a73e8;
  }
  
  [data-theme="dark"] {
    --account-bg: #1f1f1f;
    --account-card-bg: #2d2d2d;
    --account-text-primary: #e8eaed;
    --account-text-secondary: #9aa0a6;
    --account-border: #3c4043;
    --account-input-bg: #3c4043;
    --account-input-border: #5f6368;
    --account-button-bg: #8ab4f8;
    --account-button-hover: #aecbfa;
    --account-link-color: #8ab4f8;
  }
  
  .account-container {
    background-color: var(--account-bg);
    color: var(--account-text-primary);
    font-family: 'Outfit', sans-serif;
  }
  
  .account-card {
    background-color: var(--account-card-bg);
    border: 1px solid var(--account-border);
    border-radius: 12px;
    padding: 24px;
    margin-bottom: 16px;
  }
  
  .account-header {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--account-border);
  }
  
  .account-header-icon {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background-color: var(--account-button-bg);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
  }
  
  .account-title {
    font-size: 24px;
    font-weight: 600;
    color: var(--account-text-primary);
  }
  
  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 16px;
    margin-bottom: 20px;
  }
  
  .info-item {
    display: flex;
    flex-direction: column;
    gap: 8px;
    background-color: #ffffff;
    border: 2px solid var(--account-button-bg);
    border-radius: 12px;
    padding: 20px;
    transition: all 0.2s;
  }
  
  [data-theme="dark"] .info-item {
    background-color: #2d2d2d;
  }
  
  .info-item:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(26, 115, 232, 0.15);
  }
  
  .info-item-icon-wrapper {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 4px;
  }
  
  .info-label {
    font-size: 11px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    color: var(--account-button-bg);
  }
  
  .info-value {
    font-size: 16px;
    font-weight: 500;
    color: var(--account-text-primary);
    padding: 8px 0;
  }
  
  .action-link {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 10px 16px;
    background-color: var(--account-card-bg);
    border: 1px solid var(--account-border);
    border-radius: 8px;
    color: var(--account-link-color);
    text-decoration: none;
    font-weight: 500;
    font-size: 14px;
    transition: all 0.2s;
    cursor: pointer;
  }
  
  .action-link:hover {
    background-color: var(--account-input-bg);
    transform: translateY(-1px);
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  }
  
  .section-divider {
    border-top: 1px solid var(--account-border);
    margin: 24px 0;
  }
  
  .section-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }
  
  .section-title {
    font-size: 18px;
    font-weight: 600;
    color: var(--account-text-primary);
  }
  
  .form-group {
    margin-bottom: 20px;
  }
  
  .form-label {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 14px;
    font-weight: 500;
    color: var(--account-text-primary);
    margin-bottom: 8px;
  }
  
  .form-input {
    width: 100%;
    padding: 12px 16px;
    background-color: var(--account-input-bg);
    border: 1px solid var(--account-input-border);
    border-radius: 8px;
    color: var(--account-text-primary);
    font-size: 14px;
    font-family: 'Outfit', sans-serif;
    transition: all 0.2s;
  }
  
  .form-input:focus {
    outline: none;
    border-color: var(--account-button-bg);
    box-shadow: 0 0 0 3px rgba(138, 180, 248, 0.1);
  }
  
  .form-input::placeholder {
    color: var(--account-text-secondary);
  }
  
  .form-hint {
    font-size: 12px;
    color: var(--account-text-secondary);
    margin-top: 6px;
    display: flex;
    align-items: center;
    gap: 4px;
  }
  
  .form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
  }
  
  .submit-button {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 24px;
    background-color: var(--account-button-bg);
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    font-family: 'Outfit', sans-serif;
    cursor: pointer;
    transition: all 0.2s;
  }
  
  .submit-button:hover {
    background-color: var(--account-button-hover);
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(26, 115, 232, 0.3);
  }
  
  [data-theme="dark"] .submit-button {
    color: #1f1f1f;
  }
  
  [data-theme="dark"] .submit-button:hover {
    box-shadow: 0 4px 12px rgba(138, 180, 248, 0.3);
  }
  
  /* Custom scrollbar - now applies to main container */
</style>

<div class="account-container" id="account-partial-container">
  <!-- Account Information Card -->
  <div class="account-card">
    <div class="account-header">
      <div class="account-header-icon">
        <iconify-icon icon="material-symbols:account-circle" width="28" height="28"></iconify-icon>
      </div>
      <h2 class="account-title">Account</h2>
    </div>
    
    <div class="info-grid">
      
      
      <div class="info-item">
        <div class="info-item-icon-wrapper">
          <iconify-icon icon="material-symbols:badge-outline" width="16" height="16" style="color: var(--account-text-secondary)"></iconify-icon>
          <div class="info-label">Username</div>
        </div>
        <div class="info-value">{{ user.username }}</div>
      </div>
      
      <div class="info-item">
        <div class="info-item-icon-wrapper">
          <iconify-icon icon="material-symbols:mail-outline" width="16" height="16" style="color: var(--account-text-secondary)"></iconify-icon>
          <div class="info-label">Email</div>
        </div>
        <div class="info-value">{{ user.email }}</div>
      </div>

       <div class="info-item">
        <div class="info-item-icon-wrapper">
          <iconify-icon icon="mdi:whatsapp" width="16" height="16" style="color: var(--account-text-secondary)"></iconify-icon>
          <div class="info-label">WhatsApp Number</div>
        </div>
        <div class="info-value">{{ workspace.whatsapp_number|default:"Not set" }}</div>
      </div>

      <div class="info-item">
        <div class="info-item-icon-wrapper">
         <iconify-icon icon="bi:shop" width="16" height="16" style="color: var(--account-text-secondary)"></iconify-icon>
          
          <div class="info-label">Workspace Name</div>
        </div>
        <div class="info-value">{{ workspace.name }}</div>
      </div>
      
      <div class="info-item">
        <div class="info-item-icon-wrapper">
          <iconify-icon icon="material-symbols:person-outline" width="16" height="16" style="color: var(--account-text-secondary)"></iconify-icon>
          <div class="info-label">Workspace Owner</div>
        </div>
        <div class="info-value">{{ workspace.owner.get_full_name|default:workspace.owner.username }}</div>
      </div>
      
      <div class="info-item">
        <div class="info-item-icon-wrapper">
          <iconify-icon icon="material-symbols:calendar-today-outline" width="16" height="16" style="color: var(--account-text-secondary)"></iconify-icon>
          <div class="info-label">Workspace Created</div>
        </div>
        <div class="info-value">{{ workspace.created_at|date:"M d, Y" }}</div>
      </div>
      
     
    </div>
    
    <div style="margin-top: 24px;">
      <a class="action-link"
         href="#"
         hx-get="{% url 'accounts:password_change' %}"
         hx-target="#main">
        <iconify-icon icon="material-symbols:lock-reset" width="20" height="20"></iconify-icon>
        Change Password
      </a>
    </div>
  </div>

  <!-- Knowledge Configuration Card -->
  {% if workspace.active_plan.includes_ai %}
  <div class="account-card">
    <div class="section-header">
      <iconify-icon icon="material-symbols:settings-outline" width="24" height="24" style="color: var(--account-button-bg)"></iconify-icon>
      <h3 class="section-title">Knowledge Configuration</h3>
    </div>
    
    <form hx-post="{% url 'dashboard:workspace_update' %}" 
          hx-target="#account-partial-container"
          data-processing-message="Saving configuration...">
      {% csrf_token %}
      
      <div class="form-grid">
        <div class="form-group">
          <label class="form-label">
            <iconify-icon icon="material-symbols:database-outline" width="18" height="18"></iconify-icon>
            Default Qdrant URL
          </label>
          <input type="url" 
                 name="qdrant_url" 
                 value="{{ workspace.qdrant_url|default:'' }}" 
                 class="form-input" 
                 placeholder="https://xyz.qdrant.tech">
          <p class="form-hint">
            <iconify-icon icon="material-symbols:info-outline" width="14" height="14"></iconify-icon>
            Used for new knowledge chunks if not overridden
          </p>
        </div>
        
        <div class="form-group">
          <label class="form-label">
            <iconify-icon icon="material-symbols:key-outline" width="18" height="18"></iconify-icon>
            Default Qdrant API Key
          </label>
          <input type="password" 
                 name="qdrant_api_key" 
                 value="{{ workspace.qdrant_api_key|default:'' }}" 
                 class="form-input"
                 placeholder="Enter your API key">
          <p class="form-hint">
            <iconify-icon icon="material-symbols:shield-lock-outline" width="14" height="14"></iconify-icon>
            Your API key is stored securely
          </p>
        </div>
      </div>
      
      <button type="submit" class="submit-button">
        <iconify-icon icon="material-symbols:save-outline" width="20" height="20"></iconify-icon>
        Save Configuration
      </button>
    </form>
  </div>
  {% endif %}
</div>