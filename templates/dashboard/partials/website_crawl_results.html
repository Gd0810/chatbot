<div class="border-t pt-6" id="crawl-results-area">
  <div class="flex justify-between items-center mb-4">
    <h3 class="text-lg font-semibold">Results ({{ total }} pages found)</h3>
    <button onclick="copyAllContent(this)"
            class="px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 flex items-center gap-2">
      <iconify-icon icon="mdi:content-copy"></iconify-icon>
      Copy Complete Website Data
    </button>
  </div>
  
  {% if pages %}
      <!-- Visible Content Area -->
      <div id="page-content" class="space-y-8 max-h-[600px] overflow-y-auto pr-2 border rounded p-4 bg-gray-50">
        {% for page in pages %}
            <div class="page-section border-b pb-6 last:border-0 last:pb-0">
                <div class="mb-4">
                    <h4 class="font-bold text-xl text-gray-800">{{ page.title }}</h4>
                    <p class="text-sm text-gray-500">Source: <a href="{{ page.url }}" target="_blank" class="hover:underline">{{ page.url }}</a></p>
                </div>

                {% for section in page.sections %}
                <div class="mb-4">
                    {% if section.heading and section.heading != "Intro" and section.heading != "Content" %}
                    <h5 class="font-semibold text-lg text-gray-700 mb-2">{{ section.heading }}</h5>
                    {% endif %}
                    <div class="prose prose-sm max-w-none text-gray-600 space-y-2 whitespace-pre-wrap font-sans">
                        {{ section.content|default:"" }}
                    </div>
                </div>
                {% endfor %}
            </div>
        {% endfor %}
      </div>

      <!-- Hidden Consolidated Content for Copying -->
      <textarea id="full-website-content" class="hidden">{% for page in pages %}
Title: {{ page.title }}
URL: {{ page.url }}
{% for section in page.sections %}
{% if section.heading and section.heading != "Intro" and section.heading != "Content" %}
{{ section.heading }}
{% endif %}
{{ section.content|default:"" }}
{% endfor %}
{% endfor %}
</textarea>

  {% else %}
      <p class="text-gray-500 italic">No content found. Please check the URL and try again.</p>
  {% endif %}
</div>

<script>
function copyAllContent(btn) {
    const content = document.getElementById('full-website-content').value;
    
    navigator.clipboard.writeText(content).then(() => {
        const originalHTML = btn.innerHTML;
        const originalClasses = Array.from(btn.classList);

        btn.innerHTML = '<iconify-icon icon="mdi:check"></iconify-icon> Copied All Data!';
        btn.classList.remove('bg-indigo-600', 'hover:bg-indigo-700');
        btn.classList.add('bg-green-600', 'hover:bg-green-700');
        
        setTimeout(() => {
            btn.innerHTML = originalHTML;
            btn.className = originalClasses.join(' ');
        }, 2000);
    }).catch(err => {
        alert('Failed to copy: ' + err);
    });
}
</script>
